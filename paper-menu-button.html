<!--
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<!--
A `paper-menu-button` is a `paper-icon-button` that opens a drop down menu when tapped.

Example:

    <paper-menu-button icon="menu">
      <div>Menu Item 1</div>
      <div>Menu Item 2</div>
      <div>Menu Item 3</div>
    </paper-menu-button>

 @group Polymer Quantum Paper Elements
 @class paper-menu-button
 @extends paper-icon-button
-->
<link href="../polymer/polymer.html" rel="import">
<link href="../core-menu/core-menu.html" rel="import">
<link href="../paper-shadow/paper-shadow.html" rel="import">
<link href="paper-menu-button-overlay.html" rel="import">
<link href="paper-menu-button-transition.html" rel="import">

<polymer-element name="paper-menu-button" extends="paper-icon-button" attributes="opened halign" on-paper-ink-spill-complete="{{inkSpillCompleteAction}}">
  <template>
    <link rel="stylesheet" href="paper-menu-button.css">
    <paper-menu-button-overlay target="{{$.menu}}" relatedTarget="{{}}" halign="{{halign}}" opened="{{_active}}" transition="paper-menu-button-transition"></paper-menu-button-overlay>
    <paper-shadow target="{{$.menu}}"></paper-shadow>
    <core-menu id="menu">
      <content></content>
    </core-menu>
    <shadow></shadow>
  </template>
  <script>
    Polymer('paper-menu-button', {

      publish: {

        /**
         * If true, this menu is currently visible.
         *
         * @attribute opened
         * @type boolean
         * @default false
         */
        opened: { value: false, reflect: true },

        /**
         * The horizontal alignment of the pulldown menu relative to the button.
         *
         * @attribute halign
         * @type 'left' | 'right'
         * @default 'left'
         */
        halign: { value: 'left', reflect: true },

        /**
         * @attribute fillInk
         * @type boolean
         * @default true
         */
        fillInk: {value: true, reflect: false },

        /**
         * @attribute isToggle
         * @type boolean
         * @default true
         */
        isToggle: {value: true, reflect: false }

      },

      _active: false,

      _activeChanged: function() {
        this.active = this._active;
      },

      inkSpillCompleteAction: function() {
        this._active = this.active;
      },

      makeAnimation: function() {
        this.$.ink.setup();
        this.inkAnimation = new Animation(this.$.ink.$.inkEffect, [{
          'transform': 'scale(0)'
        }, {
          'transform': 'scale(1)'
        }], {
          duration: 5000
        });
      },

      /**
       * Toggle the opened state of the menu.
       *
       * @method toggle
       */
      toggle: function() {
        this.active = !this.active;
        this._active = this.active;
      }

    });
  </script>
</polymer-element>
